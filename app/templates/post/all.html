{% extends 'main/base.html' %}

{% block title %}All themes{% endblock %}

{% block style %}
<link rel="stylesheet" href="{{url_for('static', filename='css/libs/all.min.css') }}">
<link rel="stylesheet" href="{{url_for('static', filename='css/themes.css') }}">
{% endblock %}

{% block content %}
<form method="post" class="form-control d-flex flex-row gap-2" id="teacherForm">
    {{ form.csrf_token }}
    {{ form.teacher }}
    {{ form.discipline_filter }}
    {{ form.group_filter }}
    <div class="form-check ms-2">
        {{ form.show_checked }}
        <label class="form-check-label" >
            Only checked
        </label>
    </div>
    <input type="submit" class="btn btn-success" value="Show">
</form>

<div class="w-100 mt-4">
    <div class="table-responsive">
        <table class="table table-striped table-hover align-middle">
            <thead>
            <tr>
                <th scope ="col">Teacher</th>
                <th scope="col">Theme</th>
                <th scope="col">Course</th>
                <th scope="col">Group</th>
                <th scope="col">Student</th>
                <th scope="col">Status</th>
                {% if current_user.is_authenticated %}
                <th scope="col">Actions</th>
                {% endif %}
            </tr>
            </thead>
            <tbody>
            {% for post in posts %}
            <tr>
                <td data-label="Teacher">
                    <div class="teacher-name">
                        <img src="{{ url_for('static', filename='upload/' + post.author.avatar ) }}"
                             alt="Teacher" class="avatar">
                        {{ post.author.name }}
                    </div>
                </td>
                <td data-label="Theme">{{ post.subject }}</td>
                <td data-label="Course">{{ post.discipline }}</td>
                <td data-label="Group">{{ post.group_number }}</td>
                <td data-label="Student">
                    {% with student = user.query.get(post.student) %}
                    <div class="student-name">
                        <img src="{{ url_for('static', filename='upload/' + student.avatar ) }}"
                             alt="Student" class="avatar">
                        {{ student.name }}
                    </div>
                    {% endwith %}
                </td>
                <td data-label="Status">
                    {% if post.is_checked %}
                    <span class="badge bg-success">checked</span>
                    {% else %}
                    <span class="badge bg-warning text-dark">pending</span>
                    {% endif %}
                </td>
                {% if current_user.is_authenticated and post.author.id == current_user.id %}
                <td data-label="Actions">
                    <a href="{{ url_for('post.update', id=post.id) }}" class="btn btn-secondary btn-sm">
                        <i class="fa-solid fa-pen-to-square"></i> Change
                    </a>
                    <a href="{{ url_for('post.delete', id=post.id) }}" class="btn btn-danger btn-sm">
                        <i class="fa-solid fa-trash"></i> Delete
                    </a>
                </td>
                {% elif current_user.is_authenticated %}
                <td data-label="Actions"></td>
                {% endif %}
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}